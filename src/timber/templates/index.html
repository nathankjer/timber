{% extends 'base.html' %}
{% block title %}Home{% endblock %}
{% block content %}
<div class="container-fluid mt-4" data-sheet-id="{{ sheet_id }}" data-sheets='{{ sheets | tojson }}'>
  {% if current_user.is_authenticated %}
  <div class="row">
    <div class="col-md-2" id="sheet-pane">
      <div class="d-flex justify-content-between align-items-center mb-2">
        <span class="fw-bold">Sheets</span>
        <button id="new-sheet" class="btn btn-sm btn-outline-success" title="New Sheet"><i class="bi bi-plus-lg"></i></button>
      </div>
      <ul class="list-group" id="sheet-list">
        {% for s in sheets %}
        <li class="list-group-item d-flex justify-content-between align-items-center sheet-item{% if s.id == sheet_id %} active{% endif %}" data-sheet-id="{{ s.id }}">
          <span>{{ s.name }}</span>
          <i class="bi bi-trash-fill text-danger delete-sheet" role="button" aria-label="Delete"></i>
        </li>
        {% endfor %}
      </ul>
    </div>
    <div class="col-md-7" id="canvas-pane">
      <div class="d-flex justify-content-between align-items-center mb-2">
        <h2 class="mb-0" id="sheet-title"></h2>
        <i id="edit-title" class="bi bi-pencil-square" role="button"></i>
      </div>
      <svg id="canvas" style="border:1px solid #ccc; width:100%; height:400px;"></svg>
      <div class="mt-2" id="canvas-tools">
        <select id="element-type" class="form-select form-select-sm d-inline w-auto me-2">
          <option value="Joint">Joint</option>
          <option value="Member">Member</option>
          <option value="Cable">Cable</option>
          <option value="Plane">Plane</option>
          <option value="Solid">Solid</option>
          <option value="Load">Load</option>
          <option value="Support">Support</option>
        </select>
        <button id="add-btn" class="btn btn-outline-success btn-sm me-2">Add Element</button>
        <div class="btn-group btn-group-sm" role="group" aria-label="Views">
          <button type="button" class="btn btn-outline-secondary view-btn active" data-view="+X">+X</button>
          <button type="button" class="btn btn-outline-secondary view-btn" data-view="-X">-X</button>
          <button type="button" class="btn btn-outline-secondary view-btn" data-view="+Y">+Y</button>
          <button type="button" class="btn btn-outline-secondary view-btn" data-view="-Y">-Y</button>
          <button type="button" class="btn btn-outline-secondary view-btn" data-view="+Z">+Z</button>
          <button type="button" class="btn btn-outline-secondary view-btn" data-view="-Z">-Z</button>
        </div>
        <div class="btn-group btn-group-sm ms-2" role="group" aria-label="Zoom">
          <button type="button" id="zoom-in" class="btn btn-outline-secondary">+</button>
          <button type="button" id="zoom-out" class="btn btn-outline-secondary">-</button>
          <button type="button" id="home-btn" class="btn btn-outline-secondary"><i class="bi bi-house"></i></button>
        </div>
        <span class="ms-2">View: <span id="current-view">+X</span></span>
      </div>
    </div>
    <div class="col-md-3" id="properties-pane">
      <h2>Properties</h2>
      <div id="props-content" class="mb-3"></div>
      <button id="delete-btn" class="btn btn-danger btn-sm" disabled>Delete</button>
      <button id="solve-btn" class="btn btn-primary btn-sm mt-2">Solve</button>
      <pre id="solve-output" class="mt-3 small"></pre>
    </div>
  </div>
  {% else %}
  <div class="text-center">
    <p class="lead">Please <a href="{{ url_for('auth.login') }}">log in</a> or <a href="{{ url_for('auth.register') }}">sign up</a> to continue.</p>
  </div>
  {% endif %}
</div>
{% if current_user.is_authenticated %}
  <script src="{{ url_for('static', filename='index.js') }}"></script>
{% endif %}
{% endblock %}
